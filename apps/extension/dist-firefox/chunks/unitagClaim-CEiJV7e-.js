import"./preload-helper-DY04TWhi.js";import{c as ne,j as e,S as ie,P as se,aW as gn,aX as pe,r as m,aY as pn,aZ as me,a_ as N,a$ as mn,aV as q,az as At,al as k,F as h,l as E,at as It,b0 as Mt,b1 as Ge,b2 as We,b3 as fe,b4 as qe,b5 as fn,aC as re,h as y,a2 as V,b6 as Ke,ad as J,A as T,as as xe,b7 as oe,b8 as O,b9 as xn,ba as _,K as Qe,bb as Ye,aq as bn,bc as yn,aQ as be,bd as Et,be as ce,k as $e,bf as vn,aK as Tt,bg as Cn,am as Ze,bh as wn,aD as Xe,bi as jn,g as ee,bj as Pn,bk as Sn,bl as $n,bm as Dn,u as ae,bn as K,w as Rt,bo as he,T as Je,bp as Un,bq as Lt,br as Nt,f as et,av as An,bs as In,bt as ue,bu as kt,aP as Mn,bv as ye,bw as De,bx as En,by as Tn,bz as Rn,bA as Ln,bB as Nn,bC as kn,bD as Fn,bE as zn,bF as Hn,bG as On,bH as _n,bI as Vn,bJ as Bn,bK as Gn,bL as Wn,bM as qn,b as Kn,E as lt,aS as Qn,bN as Yn,bO as Zn,e as Xn,aF as tt,i as Jn,B as ei,d as ti,R as ni,aU as ii,m as si,n as ri}from"./useTestnetModeForLoggingAndAnalytics-DpJrxT3v.js";import{f as oi,U as Ft,g as Oe,u as Q,O as ve,h as ai,M as ct,C as li,T as ci,b as zt,i as z}from"./Terms-B09VeF1b.js";import{A as _e,u as ui,M as di,U as ut,a as hi,T as gi,N as pi,f as mi,b as fi,c as xi,d as bi,P as yi,R as vi,I as Ci,E as wi,C as ji,e as Pi}from"./NftViewWithContextMenu-CD6Q_0EG.js";import{A as Ve,q as H,s as Si,t as $i,v as Di,w as Ui,E as Ai,T as Ht,B as Ii,x as te,M as le,P as Ce,y as Be,l as Ot,X as Mi,z as Ei,D as Ti,C as Ri,G as dt,H as Li,J as ht,a as Ni,m as ki,K as Fi,N as zi,h as Hi,Q as Oi,S as _t,V as _i}from"./useNavigateToNftExplorerLink-CAXh3jle.js";import{u as Vi}from"./useAppInsets-jaBNt2xB.js";const[Bi]=ne({name:"Bolt",getIcon:t=>e.jsx(ie,{viewBox:"0 0 24 24",fill:"none",...t,children:e.jsx(se,{d:"M18.3841 9.42599C18.1471 8.85499 17.6161 8.5 16.9981 8.5L14.1411 8.57001L15.8571 4.59399C16.0581 4.12899 16.0111 3.59799 15.7331 3.17599C15.4551 2.75299 14.9861 2.5 14.4801 2.5H10.0001C9.16211 2.5 8.46711 3.024 8.19511 3.843L5.57811 10.525C5.42311 10.988 5.4981 11.48 5.7841 11.876C6.0701 12.272 6.51312 12.5 7.00212 12.5L9.8261 12.434L6.94109 20.838C6.86609 21.058 6.95209 21.301 7.14909 21.424C7.23109 21.475 7.32211 21.5 7.41411 21.5C7.54311 21.5 7.67111 21.45 7.76811 21.354L18.0601 11.061C18.4961 10.624 18.6201 9.99699 18.3841 9.42599Z",fill:"currentColor"})})}),[Gi]=ne({name:"Coupon",getIcon:t=>e.jsx(ie,{viewBox:"0 0 24 24",fill:"none",...t,children:e.jsx(se,{d:"M21 9.99988V6.99988C21 4.99988 20 3.99988 18 3.99988H16.05C15.884 3.99988 15.75 4.13387 15.75 4.29987V7.49988C15.75 7.90988 15.41 8.24988 15 8.24988C14.59 8.24988 14.25 7.90988 14.25 7.49988V4.29987C14.25 4.13387 14.116 3.99988 13.95 3.99988H6C4 3.99988 3 4.99988 3 6.99988V9.99988C4.1 9.99988 5 10.8999 5 11.9999C5 13.0999 4.1 13.9999 3 13.9999V16.9999C3 18.9999 4 19.9999 6 19.9999H13.95C14.116 19.9999 14.25 19.8659 14.25 19.6999V16.4999C14.25 16.0899 14.59 15.7499 15 15.7499C15.41 15.7499 15.75 16.0899 15.75 16.4999V19.6999C15.75 19.8659 15.884 19.9999 16.05 19.9999H18C20 19.9999 21 18.9999 21 16.9999V13.9999C19.9 13.9999 19 13.0999 19 11.9999C19 10.8999 19.9 9.99988 21 9.99988ZM15.75 13.2499C15.75 13.6639 15.414 13.9999 15 13.9999C14.586 13.9999 14.25 13.6639 14.25 13.2499V10.7499C14.25 10.3359 14.586 9.99988 15 9.99988C15.414 9.99988 15.75 10.3359 15.75 10.7499V13.2499Z",fill:"currentColor"})})}),[Vt]=ne({name:"Pen",getIcon:t=>e.jsx(ie,{viewBox:"0 0 13 13",fill:"none",...t,children:e.jsx(gn,{id:"pen",children:e.jsx(se,{id:"pen_2",d:"M8.94259 6.29432C8.99932 6.35105 8.99932 6.44362 8.94259 6.50035L4.56096 10.863H2.13672V8.4388L6.49941 4.05723C6.55614 4.00001 6.64828 4.00001 6.70549 4.05723L8.94259 6.29432ZM10.5779 3.49822L9.50154 2.42181C9.12142 2.04169 8.50477 2.04169 8.12465 2.42181L7.21402 3.33238C7.15729 3.38911 7.15729 3.4812 7.21402 3.53793L9.46177 5.78568C9.51849 5.84241 9.61065 5.84241 9.66738 5.78568L10.5779 4.87517C10.958 4.49505 10.958 3.87834 10.5779 3.49822Z",fill:"currentColor"})})})}),[Wi]=ne({name:"Share",getIcon:t=>e.jsx(ie,{viewBox:"0 0 24 24",fill:"none",...t,children:e.jsx(se,{d:"M7 11C6.07003 11 5.60504 11 5.22354 11.1022C4.18827 11.3796 3.37962 12.1883 3.10222 13.2235C3 13.605 3 14.07 3 15V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V15C21 14.07 21 13.605 20.8978 13.2235C20.6204 12.1883 19.8117 11.3796 18.7765 11.1022C18.395 11 17.93 11 17 11M16 7L12 3M12 3L8 7M12 3V15",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),[Bt]=ne({name:"Trash",getIcon:t=>e.jsx(ie,{viewBox:"0 0 24 24",fill:"none",...t,children:e.jsx(se,{d:"M3.5 6H5.5M5.5 6H21.5M5.5 6V20C5.5 20.5304 5.71071 21.0391 6.08579 21.4142C6.46086 21.7893 6.96957 22 7.5 22H17.5C18.0304 22 18.5391 21.7893 18.9142 21.4142C19.2893 21.0391 19.5 20.5304 19.5 20V6H5.5ZM8.5 6V4C8.5 3.46957 8.71071 2.96086 9.08579 2.58579C9.46086 2.21071 9.96957 2 10.5 2H14.5C15.0304 2 15.5391 2.21071 15.9142 2.58579C16.2893 2.96086 16.5 3.46957 16.5 4V6M10.5 11V17M14.5 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),Ue=()=>{},Ae={setDefaultMode:Ue,setInputMode:Ue,setFocusTo:Ue},qi=pe,W=()=>{},gt=()=>W,Gt=t=>({value:t,addListener:W,removeListener:W,modify:W,get:()=>t,set:W}),pt=Gt(0),Ki=Gt(null),Qi={enabled:!0,animated:{progress:new _e.Value(0),height:new _e.Value(0)},reanimated:{progress:pt,height:pt},layout:Ki,setKeyboardHandlers:gt,setInputHandlers:gt,setEnabled:W},Yi=m.createContext(Qi),nt=()=>m.useContext(Yi);pn.isEdgeToEdge();Ve.createAnimatedComponent(_e.createAnimatedComponent(qi));me.create({container:{flex:1},hidden:{display:"none",position:"absolute"}});N.OS;let Zi={height:0,duration:0,timestamp:new Date().getTime(),target:-1,type:"default",appearance:"default"};const Xi=async t=>(t==null||t.keepFocus,new Promise(r=>{{r();return}})),Ji=()=>!1,es=()=>Zi,ts={setDefaultMode:Ae.setDefaultMode,setInputMode:Ae.setInputMode,setFocusTo:Ae.setFocusTo,dismiss:Xi,isVisible:Ji,state:es},mt=mn.get("screen");let ft={width:mt.width,height:mt.height};const ns=()=>{const[t,r]=m.useState(ft);return m.useEffect(()=>(r(ft),()=>{}),[]),t},is=()=>{m.useEffect(()=>()=>ts.setDefaultMode(),[])};function ss(t,r){const i=nt();m.useLayoutEffect(()=>{const a=i.setKeyboardHandlers(t);return()=>a()},r)}function Wt(t,r){is(),ss(t,r)}const Ie=N.OS,rs=()=>{const{reanimated:t}=nt(),r=H(0),i=H(0),a=H(0),s=H(!0);return m.useLayoutEffect(()=>{const n=-t.height.value,o=t.progress.value;r.value=n,i.value=n,a.value=o,s.value=o===0},[]),Wt({onStart:n=>{"worklet";n.height>0&&(s.value=!1,r.value=n.height)},onMove:n=>{"worklet";a.value=n.progress,i.value=n.height},onInteractive:n=>{"worklet";a.value=n.progress,i.value=n.height},onEnd:n=>{"worklet";s.value=n.height===0,i.value=n.height,a.value=n.progress}},[]),{height:i,progress:a,heightWhenOpened:r,isClosed:s}},os=()=>{const{reanimated:t}=nt(),r=H(0),i=H(0);return m.useLayoutEffect(()=>{r.value=t.progress.value},[]),Wt({onStart:a=>{"worklet";a.height===0&&(r.value=0),Ie==="ios"&&(i.value=a.progress)},onMove:a=>{"worklet";Ie==="android"&&(i.value=a.progress)},onInteractive:a=>{"worklet";r.value=0,i.value=a.progress},onEnd:a=>{"worklet";r.value=a.progress,Ie==="android"&&(i.value=a.progress)}},[]),{translate:i,padding:r}};function ge(){return ge=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var a in i)({}).hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},ge.apply(null,arguments)}const as={x:0,y:0,width:0,height:0},ls=m.forwardRef(({behavior:t,children:r,contentContainerStyle:i,enabled:a=!0,keyboardVerticalOffset:s=0,style:n,onLayout:o,...c},l)=>{const u=H(null),d=Si(()=>u.value||as),{translate:p,padding:g}=os(),f=rs(),{height:b}=ns(),x=m.useCallback(()=>{"worklet";const w=b-f.heightWhenOpened.value-s;return Math.max(d.value.y+d.value.height-w,0)},[b,s]),C=m.useCallback(w=>{"worklet";return $i(w,[0,1],[0,x()])},[x]),j=m.useCallback(w=>{"worklet";(f.isClosed.value||u.value===null||t!=="height")&&(u.value=w)},[t]),v=m.useCallback(w=>{Di(j)(w.nativeEvent.layout),o==null||o(w)},[o]),P=Ui(()=>{const w=C(f.progress.value),F=C(p.value),R=C(g.value),I=a?w:0,L=d.value.height-I;switch(t){case"height":return!f.isClosed.value&&L>0?{height:L,flex:0}:{};case"position":return{bottom:I};case"padding":return{paddingBottom:I};case"translate-with-padding":return{paddingTop:R,transform:[{translateY:-F}]};default:return{}}},[t,a,C]),U=t==="position",$=U?i:n,A=m.useMemo(()=>[$,P],[$,P]);return U?q.createElement(pe,ge({ref:l,style:n,onLayout:v},c),q.createElement(Ve.View,{style:A},r)):q.createElement(Ve.View,ge({ref:l,style:A,onLayout:v},c),r)}),cs=N.OS==="android"&&N.Version>=30;cs||N.OS;Ai.bezier(.19919472913616398,.010644531250000006,.27920937042459737,.91025390625);const us=()=>ui()||"light",xt={width:13,height:2,borderRadius:1},bt={marginHorizontal:5,width:30,height:30,justifyContent:"center",alignItems:"center"};me.create({arrowUpContainer:bt,arrowDownContainer:{...bt,transform:[{rotate:"180deg"}]},arrow:{width:20,height:20,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},arrowLeftLine:{...xt,transform:[{rotate:"-45deg"}],left:-.5},arrowRightLine:{...xt,transform:[{rotate:"45deg"}],left:-5.5}});const ds=({children:t,onPress:r,disabled:i,accessibilityLabel:a,accessibilityHint:s,testID:n,style:o})=>{const c=i?pe:di,l=m.useMemo(()=>({disabled:i}),[i]);return q.createElement(c,{accessibilityHint:s,accessibilityLabel:a,accessibilityRole:"button",accessibilityState:l,style:o,testID:n,onPress:r},t)},hs=({children:t,onPress:r,disabled:i,accessibilityLabel:a,accessibilityHint:s,testID:n,rippleRadius:o=18,style:c,theme:l})=>{const u=us(),d=m.useMemo(()=>({disabled:i}),[i]),p=m.useMemo(()=>ut.Ripple(l[u].ripple,!0,o),[u,o,l]);return q.createElement(ut,{accessibilityHint:s,accessibilityLabel:a,accessibilityRole:"button",accessibilityState:d,background:p,style:c,testID:n,onPress:r},q.createElement(pe,{style:c},t))};N.select({android:hs,default:ds});const gs=42;N.OS==="ios"&&parseInt(N.Version,10)>=26;me.create({flex:{flex:1},toolbar:{position:"absolute",bottom:0,alignItems:"center",width:"100%",flexDirection:"row",height:gs},arrows:{flexDirection:"row",paddingLeft:8},doneButton:{fontWeight:"600",fontSize:15},doneButtonContainer:{marginRight:16,marginLeft:8},floating:{alignSelf:"center",borderRadius:20,overflow:"hidden"}});me.create({absolute:{position:"absolute"},stretch:{top:0,bottom:0,left:0,right:0}});function it({onBack:t}){return e.jsx(Ht,{hoverable:!0,borderRadius:"$roundedFull",p:"$spacing4",position:"absolute",zIndex:At.default,onPress:t,children:e.jsx(Ii,{color:"$neutral2",size:"$icon.24"})})}const ps=({isSubmitButtonDisabled:t,isCheckingUnitag:r,isChangeResponseLoading:i,onPressSaveChanges:a})=>{const{t:s}=k();return e.jsx(h,{row:!0,width:"100%",pt:"$spacing4",children:e.jsx(E,{isDisabled:t,loading:r||i,testID:te.Confirm,variant:"branded",emphasis:"primary",onPress:a,children:s("common.button.save")})})},ms=(t,r)=>{const{data:i}=It(Mt()),a=!i,{isLoading:s,data:n}=hi({params:a?void 0:{address:t,deviceId:i,isUsernameChange:r}});return{canClaimUnitag:!s&&!!(n!=null&&n.canClaim),errorCode:n==null?void 0:n.errorCode}};function fs({unitag:t,address:r,keyboardHeight:i=0,onClose:a,onSuccess:s}){const{t:n}=k(),o=Ge(),{data:c}=It(Mt()),l=We(r),u=fe(),[d,p]=m.useState(t),[g,f]=m.useState(!1),[b,x]=m.useState(!1),{error:C,loading:j}=oi(d),{errorCode:v}=ms(r,!0),P=qe(),U=t!==d,$=!!d&&U&&!C&&!j,A=v===fn.AddressLimitReached,w=!c||A||!$,F=()=>{},R=()=>{f(!1)},I=()=>{$&&f(!0)},L=async()=>{if(!c){T.error(new Error("DeviceId is undefined"),{tags:{file:"ChangeUnitagModal",function:"onChangeSubmit"}});return}f(!1),x(!0);try{const S=await xe.changeUnitag({data:{username:d,deviceId:c},address:l.address,signMessage:oe(l,u)});if(x(!1),!S.success&&S.errorCode){o(O({type:_.Error,errorMessage:xn(n,S.errorCode)}));return}S.success&&(Qe(Ye.UnitagChanged),P(),o(O({type:_.Success,title:n("unitags.notification.username.title")})),s==null||s(),a())}catch(S){T.error(S,{tags:{file:"ChangeUnitagModal",function:"onChangeSubmit"}}),o(O({type:_.Error,errorMessage:n("unitags.notification.username.error")})),a(),x(!1)}},D=i+-20;return e.jsxs(e.Fragment,{children:[g&&e.jsx(xs,{unitag:d,onChangeSubmit:L,onClose:R}),e.jsxs(le,{isDismissible:!0,name:re.UnitagsChange,onClose:a,children:[e.jsx(it,{onBack:a}),e.jsx(ls,{children:e.jsxs(h,{px:void 0,pb:i>0?D:"$spacing12",children:[e.jsxs(h,{centered:!0,gap:"$spacing12",pt:"$spacing24",children:[e.jsx(h,{centered:!0,backgroundColor:"$surface2",borderRadius:"$rounded12",height:"$spacing48",minWidth:"$spacing48",children:e.jsx(Ce,{color:"$neutral1",size:"$icon.24"})}),e.jsx(y,{textAlign:"center",variant:"subheading1",children:n("unitags.editUsername.title")}),e.jsxs(h,{row:!0,alignItems:"center",borderColor:"$surface3",borderRadius:"$rounded16",borderWidth:"$spacing1",px:"$spacing24",mt:"$spacing12",width:"100%",children:[e.jsx(Be,{autoFocus:!0,autoCapitalize:"none",color:"$neutral1",fontFamily:"$subHeading",fontSize:V.subheading1.fontSize,fontWeight:"$book",m:"$none",maxLength:20,numberOfLines:1,px:"$none",py:"$spacing20",returnKeyType:"done",value:d,width:"100%",onChangeText:S=>p(S.trim().toLowerCase()),onSubmitEditing:F}),e.jsx(h,{position:"absolute",right:"$spacing20",top:"$spacing20",children:e.jsx(y,{color:"$neutral3",variant:"subheading1",children:Ke})})]}),A?e.jsx(h,{backgroundColor:"$statusCritical2",borderRadius:"$rounded16",px:"$spacing16",py:"$spacing12",width:"100%",children:e.jsx(y,{color:"$statusCritical",variant:"body3",children:n("unitags.editUsername.warning.max")})}):e.jsx(h,{backgroundColor:"$surface2",borderRadius:"$rounded16",px:"$spacing16",py:"$spacing12",width:"100%",children:e.jsx(y,{color:"$neutral2",variant:"body3",children:e.jsx(gi,{components:{highlight:e.jsx(y,{color:"$statusCritical",variant:"body3"})},i18nKey:"unitags.editUsername.warning.default"})})}),e.jsx(h,{centered:!0,row:!0,gap:"$spacing8",minHeight:V.body3.lineHeight,children:U&&C&&e.jsx(y,{color:"$statusCritical",textAlign:"center",variant:"body3",children:C})})]}),e.jsx(ps,{isSubmitButtonDisabled:w,isCheckingUnitag:j,isChangeResponseLoading:b,onPressSaveChanges:I})]})})]})]})}function xs({unitag:t,onClose:r,onChangeSubmit:i}){const{t:a}=k();return e.jsxs(le,{isDismissible:!0,name:re.UnitagsChangeConfirm,onClose:r,children:[e.jsx(it,{onBack:r}),e.jsxs(h,{centered:!0,gap:"$spacing12",pb:"$spacing12",pt:"$spacing24",px:"$spacing24",children:[e.jsx(h,{centered:!0,backgroundColor:"$statusCritical2",borderRadius:"$rounded12",height:"$spacing48",mb:"$spacing8",minWidth:"$spacing48",children:e.jsx(Ot,{color:"$statusCritical",size:"$icon.24"})}),e.jsx(y,{textAlign:"center",variant:"subheading1",children:a("unitags.editUsername.confirm.title")}),e.jsx(y,{color:"$neutral2",textAlign:"center",variant:"body3",children:a("unitags.editUsername.confirm.subtitle")}),e.jsx(h,{py:"$spacing32",children:e.jsx(Ft,{animateText:!0,name:t,textProps:{fontSize:V.heading3.fontSize}})}),e.jsxs(h,{row:!0,gap:"$spacing12",width:"100%",children:[J,e.jsx(E,{testID:te.Remove,size:"large",variant:"critical",emphasis:"secondary",onPress:i,children:a("common.button.confirm")})]})]})]})}function bs({unitag:t,address:r,onClose:i,onSuccess:a}){const{t:s}=k(),n=Ge(),o=qe(),c=We(r),l=fe(),[u,d]=m.useState(!1),p=()=>{d(!1),n(O({type:_.Error,errorMessage:s("unitags.notification.delete.error")})),i()},g=async()=>{try{d(!0);const f=await xe.deleteUnitag({data:{username:t},address:c.address,signMessage:oe(c,l)});if(d(!1),!f.success){p();return}Qe(Ye.UnitagRemoved),o(),n(O({type:_.Success,title:s("unitags.notification.delete.title")})),a==null||a(),i()}catch(f){T.error(f,{tags:{file:"DeleteUnitagModal",function:"onDelete"}}),p()}};return e.jsxs(le,{isDismissible:!0,name:re.UnitagsDelete,onClose:i,children:[e.jsx(it,{onBack:i}),e.jsxs(h,{centered:!0,gap:"$spacing12",pb:"$spacing12",pt:"$spacing24",px:"$spacing24",children:[e.jsx(h,{centered:!0,backgroundColor:"$statusCritical2",borderRadius:"$rounded12",height:"$spacing48",mb:"$spacing8",minWidth:"$spacing48",children:e.jsx(Ot,{color:"$statusCritical",size:"$icon.24"})}),e.jsx(y,{textAlign:"center",variant:"subheading1",children:s("unitags.delete.confirm.title")}),e.jsx(y,{color:"$neutral2",textAlign:"center",variant:"body3",children:s("unitags.delete.confirm.subtitle")}),e.jsx(h,{py:"$spacing24",children:e.jsx(Ft,{animateText:!0,name:t,textProps:{fontSize:V.heading3.fontSize}})}),e.jsx(h,{row:!0,width:"100%",children:e.jsx(E,{loading:u,isDisabled:u,testID:te.Remove,variant:"critical",emphasis:"secondary",size:"large",onPress:g,children:s("common.button.delete")})})]})]})}const Z={maxWidth:500,maxHeight:500,quality:1,maxFileSizeBytes:5*1024*1024,allowedTypes:["image/jpeg","image/jpg","image/png","image/webp"]};function ys(t){return new Promise((r,i)=>{const a=document.createElement("canvas"),s=a.getContext("2d"),n=new Image;n.onload=()=>{const{maxWidth:o,maxHeight:c}=Z;let{width:l,height:u}=n;if(l>u?l>o&&(u=u*o/l,l=o):u>c&&(l=l*c/u,u=c),a.width=l,a.height=u,!s){i(new Error("Could not get canvas context"));return}s.drawImage(n,0,0,l,u),a.toBlob(d=>{if(!d){i(new Error("Could not convert canvas to blob"));return}const p=new FileReader;p.onload=()=>r(p.result),p.onerror=()=>i(new Error("Could not read resized image")),p.readAsDataURL(d)},t.type,Z.quality)},n.onerror=()=>i(new Error("Could not load image")),n.src=URL.createObjectURL(t)})}async function qt(){return new Promise(t=>{const r=document.createElement("input");r.type="file",r.accept=Z.allowedTypes.join(","),r.onchange=async i=>{var a;try{const n=(a=i.target.files)==null?void 0:a[0];if(!n){t(void 0);return}if(!Z.allowedTypes.some(c=>c===n.type)){t(void 0);return}if(n.size>Z.maxFileSizeBytes){t(void 0);return}const o=await ys(n);t(o)}catch{t(void 0)}},r.oncancel=()=>{t(void 0)},r.click()})}function Kt({address:t,avatarImageUri:r,setAvatarImageUri:i,showModal:a}){const{gqlChains:s}=bn(),{data:n}=yn({variables:{ownerAddress:t,first:pi,filter:{filterSpam:!1},chains:s}}),o=mi(n),c=o!==void 0&&o.length>0;return c||r&&r!==""?{avatarSelectionHandler:async()=>a(),hasNFTs:c}:{avatarSelectionHandler:async()=>{const u=await qt();u&&i(u)},hasNFTs:c}}const vs=610,Qt={includeContextMenu:!1,itemMargin:"$spacing6",containerProps:{m:-6},modalMaxWidth:vs,numColumns:4},Cs=({address:t,includeContextMenu:r=!0,itemMargin:i="$spacing4",numColumns:a,containerProps:s,modalMaxWidth:n,setPhotoUri:o,onClose:c})=>{const l=be();Vi();const{t:u}=k(),d=Et(),p=f=>{const b=()=>{o(f.imageUrl),c()},x=Object.keys(d);return e.jsx(h,{fill:!0,m:i,children:r?e.jsx(xi,{item:f,owner:t,walletAddresses:x,onPress:b}):e.jsx(bi,{item:f,walletAddresses:x,onPress:b})})},g=J;return e.jsx(le,{overrideInnerContainer:!0,backgroundColor:l.surface1.val,hideHandlebar:!1,isDismissible:g,name:re.NftCollection,maxWidth:n,padding:ce.spacing24,onClose:c,children:e.jsxs(h,{fill:!0,gap:"$spacing24",children:[e.jsxs(h,{row:!0,centered:!0,children:[e.jsx(h,{grow:!0,centered:!0,children:e.jsx(y,{color:"$neutral1",variant:"subheading1",children:u("unitags.choosePhoto.option.nft")})}),e.jsx(Mi,{position:"absolute",left:0,size:"$icon.24",cursor:"pointer",color:"$neutral2",onPress:c})]}),e.jsx(h,{fill:!0,...s,children:e.jsx(fi,{renderedInModal:g,owner:t,renderNFTItem:p,contentContainerStyle:{paddingHorizontal:ce.spacing12,paddingTop:ce.spacing12,paddingBottom:void 0},numColumns:a})})]})})},Yt=({address:t,hasNFTs:r,nftModalProps:i,setPhotoUri:a,onClose:s,showRemoveOption:n})=>{const o=be(),[c,l]=m.useState(!1),u=async()=>{l(!0)},d=()=>{l(!1),s()},p=async()=>{a(void 0),s()},g=async()=>{const b=await qt();s(),b&&a(b)},f=[{item:e.jsx(Me,{type:"camera-roll",onPress:g},$e.OpenCameraRoll)}];return r&&f.push({item:e.jsx(Me,{type:"nfts-list",onPress:u},$e.OpenNftsList)}),n&&f.push({item:e.jsx(Me,{type:"remove-photo",onPress:p},$e.Remove)}),e.jsxs(e.Fragment,{children:[e.jsx(le,{isDismissible:!0,backgroundColor:o.surface1.val,hideHandlebar:!1,name:re.ChooseProfilePhoto,onClose:s,children:e.jsx(h,{centered:!0,gap:"$spacing24",pt:"$spacing8",px:"$spacing24",children:e.jsx(h,{gap:"$spacing12",width:"100%",children:f.map(b=>b.item)})})}),c&&t&&e.jsx(Cs,{address:t,setPhotoUri:a,onClose:d,...i})]})},Me=({type:t,onPress:r})=>{const{t:i}=k(),{buttonText:a,icon:s}=t==="camera-roll"?{buttonText:i("unitags.choosePhoto.option.computer"),icon:e.jsx(Wi,{})}:t==="nfts-list"?{buttonText:i("unitags.choosePhoto.option.nft"),icon:e.jsx(yi,{})}:{buttonText:i("unitags.choosePhoto.option.remove"),icon:e.jsx(Bt,{})};return e.jsx(h,{row:!0,children:e.jsx(E,{icon:s,size:"large",variant:t==="remove-photo"?"critical":"default",emphasis:"secondary",justifyContent:"flex-start",onPress:r,children:a})})};m.memo(function({color:r,borderRadius:i,minOpacity:a,maxOpacity:s}){return e.jsxs(Ei,{height:"100%",width:"100%",children:[e.jsxs(Ti,{children:[e.jsx(Ri,{id:"clip",children:e.jsx(dt,{height:"100%",rx:i,width:"100%"})}),e.jsxs(Li,{cy:"-0.1",id:"background",rx:"0.8",ry:"1.1",children:[e.jsx(ht,{offset:"0",stopColor:r,stopOpacity:s??"0.6"}),e.jsx(ht,{offset:"1",stopColor:r,stopOpacity:a??"0"})]})]}),e.jsx(dt,{clipPath:i?"url(#clip)":void 0,fill:"url(#background)",height:"100%",width:"100%",x:"0",y:"0"})]})});const ws=({unitag:t,account:r,signerManager:i})=>{const[a,s]=m.useState(!1),[n,o]=m.useState();return m.useEffect(()=>{const c=async()=>{try{s(!0);const u=await xe.getUnitagAvatarUploadUrl({data:{username:t},address:r.address,signMessage:oe(r,i)});o(u)}catch(u){T.error(u,{tags:{file:"EditUnitagProfileScreen",function:"fetchAvatarUploadUrl"}})}finally{s(!1)}};c().catch(u=>{T.error(u,{tags:{file:"EditUnitagProfileScreen",function:"fetchAvatarUploadUrl"}})});const l=setInterval(c,(vn-10)*Tt);return()=>clearInterval(l)},[t,r,i]),{avatarUploadUrlLoading:a,avatarUploadUrlResponse:n}};function st({address:t,unitagAvatarUri:r,size:i}){const a=be();return r?e.jsx(h,{shrink:!0,backgroundColor:"$surface1",borderColor:"$surface1",borderRadius:"$roundedFull",borderWidth:"$spacing2",height:i,overflow:"hidden",shadowColor:"$neutral3",shadowOpacity:.4,shadowRadius:"$spacing4",width:i,children:Cn(r)?e.jsx(vi,{backgroundColor:a.surface1.val,height:i,uri:r,width:i}):e.jsx(Ci,{resizeMode:"cover",uri:r})}):e.jsx(Ni,{address:t,showBackground:!0,showBorder:!0,size:i})}const Ee="$none";function js({loading:t,updatedMetadata:r,initialMetadata:i}){return!t&&(X(i==null?void 0:i.avatar,r.avatar)||X(i==null?void 0:i.description,r.description)||X(i==null?void 0:i.twitter,r.twitter))}function X(t,r){return(t===void 0||t==="")&&(r===void 0||r==="")?!1:t!==r}function Ps({address:t,unitag:r,entryPoint:i,onNavigate:a,onButtonClick:s}){const{t:n}=k(),o=We(t),c=be(),l=fe(),u=Ge(),{data:d,isLoading:p}=Ze({params:t?{address:t}:void 0}),g=d==null?void 0:d.metadata,{value:f,setFalse:b,setTrue:x}=ki(!1),[C,j]=m.useState(g==null?void 0:g.twitter),[v,P]=m.useState(g==null?void 0:g.avatar),[U,$]=m.useState(!1),[A,w]=m.useState(g==null?void 0:g.description),[F,R]=m.useState(!1),I=wn(g);m.useEffect(()=>{!I&&!!g&&(P(g.avatar),w(g.description),j(g.twitter),$(!1))},[g,I]);const L=qe(),{avatarUploadUrlResponse:D,avatarUploadUrlLoading:S}=ws({unitag:r,account:o,signerManager:l}),Y={...v?{avatar:v}:{},description:A,twitter:C},ot=Xe(),{name:je}=Fi({nameOrAddress:t,autocompleteDomain:!0}),sn=M=>{const G=$n(M);j(G)},rn=js({loading:U||f,updatedMetadata:Y,initialMetadata:g}),{colors:B}=jn(v),{color:Pe}=zi(t,!1);m.useMemo(()=>v&&!B?[c.surface1.val,c.surface1.val]:v&&B&&B.base?[B.base,B.base]:[Pe,Pe],[v,B,c.surface1.val,Pe]);const on=()=>{R(!0)},an=()=>{R(!1)},{avatarSelectionHandler:ln,hasNFTs:cn}=Kt({address:t,avatarImageUri:v,setAvatarImageUri:P,showModal:on}),un=async()=>{x();try{const{success:M,skipped:G}=await Dn({avatarImageUri:v,avatarUploadUrlResponse:D,avatarUploadUrlLoading:S});if(!M){b(),Se();return}await dn(!G)}catch(M){T.error(M,{tags:{file:"EditUnitagProfileScreen",function:"onPressSaveChanges"}}),Se()}finally{setTimeout(b,250)}},dn=async M=>{const G=M?{...Y,avatar:D!=null&&D.avatarUrl?D.avatarUrl+`?${Date.now()}`:void 0}:Y;$(!0);const hn=await xe.updateUnitagMetadata({username:r,data:{metadata:G,clearAvatar:G.avatar===void 0},address:o.address,signMessage:oe(o,l)});if($(!1),!hn.success){Se();return}Qe(Ye.UnitagMetadataUpdated,{avatar:M,description:X(g==null?void 0:g.description,Y.description),twitter:X(g==null?void 0:g.twitter,Y.twitter)}),u(O({type:_.Success,title:n("unitags.notification.profile.title")})),L(),M&&P(D==null?void 0:D.avatarUrl),i===Oe.UnitagConfirmation&&(a==null||a()),s==null||s()},Se=()=>{u(O({type:_.Error,errorMessage:n("unitags.notification.profile.error")}))},at={blurOnSubmit:!0,fontFamily:"$body",fontSize:"$medium",fontWeight:"300",p:"$none",placeholderTextColor:"$neutral3",returnKeyType:"done",textAlign:"left",borderRadius:0};return e.jsxs(e.Fragment,{children:[e.jsx(Hi,{contentContainerStyle:{pb:"$spacing24"},keyboardShouldPersistTaps:"handled",px:void 0,showsVerticalScrollIndicator:!1,children:e.jsx(h,{grow:!0,gap:"$spacing36",children:e.jsxs(h,{fill:!0,justifyContent:"space-between",children:[e.jsxs(h,{pt:"$spacing48",pb:"$spacing48",children:[J,e.jsxs(h,{bottom:ce.spacing16,cursor:"pointer",mx:Ee,position:"absolute",onPress:ln,children:[e.jsx(h,{backgroundColor:"$surface1",borderRadius:"$roundedFull",children:e.jsx(st,{address:t,size:ee.icon70,unitagAvatarUri:v})}),e.jsx(h,{backgroundColor:"$surface1",borderRadius:"$roundedFull",bottom:-2,p:"$spacing2",position:"absolute",right:-2,children:e.jsx(h,{backgroundColor:ot?"$neutral3":"$neutral2",borderRadius:"$roundedFull",p:6,children:e.jsx(Vt,{color:ot?"$neutral1":"$surface1",size:"$icon.16"})})})]})]}),e.jsxs(h,{alignItems:"flex-start",gap:"$spacing2",pb:"$spacing16",px:Ee,children:[e.jsx(Oi,{displayName:{name:r,type:Pn.Unitag},textProps:{variant:"heading3"}}),e.jsx(y,{color:"$neutral2",variant:"subheading2",children:Sn({address:t})})]}),e.jsxs(h,{row:!0,gap:"$spacing24",px:Ee,pt:"$spacing16",children:[e.jsxs(h,{flex:1.5,gap:"$spacing24",children:[e.jsx(y,{color:"$neutral2",pt:"$spacing4",variant:"subheading1",children:n("unitags.profile.bio.label")}),e.jsx(y,{color:"$neutral2",variant:"subheading1",children:n("unitags.profile.links.twitter")}),je&&e.jsx(y,{color:"$neutral2",variant:"subheading1",children:"ENS"})]}),e.jsxs(h,{flex:2.5,gap:"$spacing24",children:[p?null:e.jsx(Be,{autoCorrect:!0,height:V.subheading1.lineHeight,placeholder:n("unitags.profile.bio.placeholder"),value:A,verticalAlign:"top",onChangeText:w,...at,mt:"$spacing4"}),p?null:e.jsxs(h,{row:!0,gap:"$none",children:[e.jsx(y,{color:"$neutral3",children:"@"}),e.jsx(Be,{autoCapitalize:"none",autoComplete:"off",autoCorrect:!1,height:V.subheading1.lineHeight,placeholder:n("unitags.editProfile.placeholder"),value:C,verticalAlign:"top",onChangeText:sn,...at})]}),je&&e.jsx(y,{color:"$neutral2",variant:"body2",children:je})]})]})]})})}),e.jsx(E,{loading:f,isDisabled:!rn,mt:"$spacing12",mx:void 0,size:"large",variant:"branded",fill:!1,onPress:un,children:n("common.button.save")}),F&&e.jsx(Yt,{address:t,hasNFTs:cn,setPhotoUri:P,showRemoveOption:!!v,nftModalProps:Qt,onClose:an})]})}function Zt({enableBack:t=!1}){const{t:r}=ae(),i=K(),{data:a,isPending:s,isFetching:n}=Ze({params:i?{address:i}:void 0}),o=a==null?void 0:a.username;m.useEffect(()=>{!s&&!n&&!o&&Rt(`/${he.ClaimIntro}`)},[o,s,n]);const{goToPreviousStep:c}=Q(),[l,u]=m.useState(!1),[d,p]=m.useState(!1),g=m.useMemo(()=>[{label:r("unitags.profile.action.edit"),onPress:()=>p(!0),Icon:wi},{label:r("unitags.profile.action.delete"),onPress:()=>u(!0),Icon:Bt,destructive:!0}],[r]),f=async()=>{await Lt.sendMessage({type:Nt.RefreshUnitags})};return e.jsx(Je,{logImpression:!0,screen:Oe.EditProfile,children:e.jsx(ve,{noTopPadding:!0,title:r("settings.setting.wallet.action.editProfile"),endAdornment:e.jsx(ji,{closeOnClick:!0,itemId:i,menuOptions:g,onLeftClick:!0,children:e.jsx(h,{children:e.jsx(Pi,{color:"$neutral2",size:"$icon.24"})})}),onBack:t?c:void 0,children:e.jsx(h,{gap:"$spacing12",width:"100%",pt:"$spacing8",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(Ps,{address:i,unitag:o,entryPoint:Oe.EditProfile}),e.jsxs(Un,{children:[l&&e.jsx(bs,{address:i,unitag:o,onSuccess:f,onClose:()=>u(!1)}),d&&e.jsx(fs,{address:i,unitag:o,onSuccess:f,onClose:()=>p(!1)})]})]})})})})}const de={unitag:void 0,profilePicUri:void 0,entryPoint:et.Home,setUnitag:()=>{},setProfilePicUri:()=>{},setEntryPoint:()=>{}},Xt=m.createContext(de);function Ss({children:t}){const[r,i]=m.useState(de.unitag),[a,s]=m.useState(de.profilePicUri),[n,o]=m.useState(de.entryPoint),c=m.useMemo(()=>({unitag:r,profilePicUri:a,entryPoint:n,setUnitag:i,setProfilePicUri:s,setEntryPoint:o}),[n,a,r]);return e.jsx(Xt.Provider,{value:c,children:t})}function rt(){return m.useContext(Xt)}function $s(t){switch(t){case et.Home:case ct.Home:return"home";case ct.Settings:return"settings";case ai.Landing:return"onboarding";default:throw new Error(`unhandled entryPoint for ChooseProfilePictureScreen: ${t}`)}}function Ds({address:t,unitag:r,shouldHandleClaim:i,entryPoint:a,unitagFontSize:s,nftModalProps:n,onContinue:o}){const{t:c}=k(),{data:l}=An(t),u=In(),d=Xe(),p=Et(),g=fe(),f=p[t],[b,x]=m.useState(),[C,j]=m.useState(!1),[v,P]=m.useState(),[U,$]=m.useState(!1),A=()=>{j(!0)},w=()=>{j(!1)},{avatarSelectionHandler:F,hasNFTs:R}=Kt({address:t,avatarImageUri:b,setAvatarImageUri:x,showModal:A}),I=async()=>{i?await L():o(b)},L=async()=>{$(!0);const D=$s(a),{claimError:S}=await u({claim:{address:t,username:r,avatarUri:b},context:{source:D,hasENSAddress:!!l},signMessage:oe(f,g)});$(!1),P(S),S===void 0&&o(b)};return e.jsxs(e.Fragment,{children:[e.jsxs(h,{centered:!0,gap:"$spacing20",mt:"$spacing24",children:[e.jsxs(Ht,{onPress:F,children:[e.jsx(h,{px:"$spacing4",children:e.jsx(Us,{address:t,imageUri:b})}),e.jsx(h,{backgroundColor:"$surface1",borderRadius:"$roundedFull",bottom:-2,p:"$spacing4",position:"absolute",right:-2,testID:te.Edit,children:e.jsx(h,{backgroundColor:d?"$neutral3":"$neutral2",borderRadius:"$roundedFull",p:8,children:e.jsx(Vt,{color:d?"$neutral1":"$surface1",size:"$icon.16"})})})]}),e.jsx(h,{row:!0,children:J}),!!v&&e.jsx(y,{color:"$statusCritical",variant:"body2",children:v})]}),J,e.jsx(h,{row:!0,children:e.jsx(E,{loading:U,testID:te.Continue,isDisabled:!!v||U,size:"medium",variant:"branded",onPress:I,children:c("common.button.continue")})}),C&&e.jsx(Yt,{address:t,hasNFTs:R,nftModalProps:n,showRemoveOption:!!b,setPhotoUri:x,onClose:w})]})}function Us({address:t,imageUri:r}){return t?e.jsx(st,{address:t,size:ue.image100,unitagAvatarUri:r}):e.jsx(h,{borderRadius:"$roundedFull",height:ue.image100,overflow:"hidden",width:ue.image100})}function As(){const{t}=ae(),{goToNextStep:r,goToPreviousStep:i}=Q(),{unitag:a,entryPoint:s,setProfilePicUri:n}=rt(),o=K(),c=m.useCallback(async l=>{n(l),await Lt.sendMessage({type:Nt.RefreshUnitags}),r()},[n,r]);return m.useEffect(()=>{a||T.warn("UnitagChooseProfilePicScreen.tsx","render","unitag is empty when it should have a value")},[a]),e.jsx(Je,{logImpression:!0,screen:kt.CreateUsername,children:e.jsx(ve,{Icon:e.jsx(_t,{backgroundColor:"$surface2",borderRadius:"$rounded12",height:ee.icon48,width:ee.icon48,children:e.jsx(Ce,{color:"$neutral1",size:"$icon.24"})}),title:t("unitags.onboarding.profile.title"),subtitle:t("unitags.onboarding.profile.subtitle"),onBack:i,children:e.jsx(h,{gap:"$spacing24",pt:"$spacing24",width:"100%",children:e.jsx(Ds,{shouldHandleClaim:!0,entryPoint:s,address:o,unitag:a??"",unitagFontSize:V.heading3.fontSize,nftModalProps:Qt,onContinue:c})})})})}var Te,yt;function Jt(){if(yt)return Te;yt=1;function t(i){var a=i.length,s=1,n=new Array(a),o;for(o=a;o>0;o--)n[o-1]=s,s=s*i[o-1];return{stride:n,data:new Uint32Array(s)}}function r(i){var a=i.length,s=1,n=new Array(a),o=[],c,l;for(c=a;c>0;c--)n[c-1]=s,s=s*i[c-1];for(l=0;l<s;l++)o.push([]);return{stride:n,data:o}}return Te={integer:t,array:r},Te}var Re,vt;function en(){if(vt)return Re;vt=1,Re=t;function t(r,i){var a=new Array(r),s=Math.floor(r/2)<<1,n=0,o,c,l,u,d;for(d=0;d<s;d+=2)o=-2*Math.log(i()),c=Math.sqrt(o),l=2*Math.PI*i(),n+=o,a[d]=c*Math.cos(l),a[d+1]=c*Math.sin(l);if(r%2){var p=Math.sqrt(-2*Math.log(i()))*Math.cos(2*Math.PI*i());a[r-1]=p,n+=Math.pow(p,2)}for(u=1/Math.sqrt(n),d=0;d<r;++d)a[d]*=u;return a}return Re}var Le,Ct;function Is(){return Ct||(Ct=1,Le=function(r,i){r=r||1,i=i||2;for(var a=r*2+1,s=Math.pow(a,i)-1,n=new Array(s),o=0;o<s;o++)for(var c=n[o]=new Array(i),l=o<s/2?o:o+1,u=1;u<=i;u++){var d=l%Math.pow(a,u);c[u-1]=d/Math.pow(a,u-1)-r,l-=d}return n}),Le}var Ne,wt;function tn(){if(wt)return Ne;wt=1;var t=Is();function r(s){var n=t(2,s),o=[],c;for(n=n.filter(function(l){for(var u=0,d=0;d<s;d++)u+=Math.pow(Math.max(0,Math.abs(l[d])-1),2);return u<s}),c=0;c<s;c++)o.push(0);return n.push(o),n.sort(function(l,u){var d=0,p=0,g;for(g=0;g<s;g++)d+=Math.pow(l[g],2),p+=Math.pow(u[g],2);return d<p?-1:d>p?1:0}),n}var i={};function a(s){return i[s]||(i[s]=r(s)),i[s]}return Ne=a,Ne}var ke,jt;function Ms(){if(jt)return ke;jt=1;var t=Jt().integer,r=en(),i=tn();function a(n,o){for(var c=0,l=0;l<n.length;l++)c+=Math.pow(n[l]-o[l],2);return c}function s(n,o){if(typeof n.distanceFunction=="function")throw new Error("PoissonDiskSampling: Tried to instantiate the fixed density implementation with a distanceFunction");this.shape=n.shape,this.minDistance=n.minDistance,this.maxDistance=n.maxDistance||n.minDistance*2,this.maxTries=Math.ceil(Math.max(1,n.tries||30)),this.rng=o||Math.random;for(var c=0,l=0;l<this.shape.length;l++)c=Math.max(c,this.shape[l]);var u=Math.max(1,c/128|0),d=1e-14*u;this.dimension=this.shape.length,this.squaredMinDistance=this.minDistance*this.minDistance,this.minDistancePlusEpsilon=this.minDistance+d,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.minDistance/Math.sqrt(this.dimension),this.neighbourhood=i(this.dimension),this.currentPoint=null,this.processList=[],this.samplePoints=[],this.gridShape=[];for(var l=0;l<this.dimension;l++)this.gridShape.push(Math.ceil(this.shape[l]/this.cellSize));this.grid=t(this.gridShape)}return s.prototype.shape=null,s.prototype.dimension=null,s.prototype.minDistance=null,s.prototype.maxDistance=null,s.prototype.minDistancePlusEpsilon=null,s.prototype.squaredMinDistance=null,s.prototype.deltaDistance=null,s.prototype.cellSize=null,s.prototype.maxTries=null,s.prototype.rng=null,s.prototype.neighbourhood=null,s.prototype.currentPoint=null,s.prototype.processList=null,s.prototype.samplePoints=null,s.prototype.gridShape=null,s.prototype.grid=null,s.prototype.addRandomPoint=function(){for(var n=new Array(this.dimension),o=0;o<this.dimension;o++)n[o]=this.rng()*this.shape[o];return this.directAddPoint(n)},s.prototype.addPoint=function(n){var o,c=!0;if(n.length===this.dimension)for(o=0;o<this.dimension&&c;o++)c=n[o]>=0&&n[o]<this.shape[o];else c=!1;return c?this.directAddPoint(n):null},s.prototype.directAddPoint=function(n){var o=0,c=this.grid.stride,l;for(this.processList.push(n),this.samplePoints.push(n),l=0;l<this.dimension;l++)o+=(n[l]/this.cellSize|0)*c[l];return this.grid.data[o]=this.samplePoints.length,n},s.prototype.inNeighbourhood=function(n){var o=this.dimension,c=this.grid.stride,l,u,d,p,g;for(l=0;l<this.neighbourhood.length;l++){for(u=0,d=0;d<o;d++){if(p=(n[d]/this.cellSize|0)+this.neighbourhood[l][d],p<0||p>=this.gridShape[d]){u=-1;break}u+=p*c[d]}if(u!==-1&&this.grid.data[u]!==0&&(g=this.samplePoints[this.grid.data[u]-1],a(n,g)<this.squaredMinDistance))return!0}return!1},s.prototype.next=function(){for(var n,o,c,l,u,d,p;this.processList.length>0;){for(this.currentPoint===null&&(this.currentPoint=this.processList.shift()),l=this.currentPoint,n=0;n<this.maxTries;n++){for(d=!0,c=this.minDistancePlusEpsilon+this.deltaDistance*this.rng(),this.dimension===2?(o=this.rng()*Math.PI*2,u=[Math.cos(o),Math.sin(o)]):u=r(this.dimension,this.rng),p=0;d&&p<this.dimension;p++)u[p]=l[p]+u[p]*c,d=u[p]>=0&&u[p]<this.shape[p];if(d&&!this.inNeighbourhood(u))return this.directAddPoint(u)}n===this.maxTries&&(this.currentPoint=null)}return null},s.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},s.prototype.getAllPoints=function(){return this.samplePoints},s.prototype.getAllPointsWithDistance=function(){throw new Error("PoissonDiskSampling: getAllPointsWithDistance() is not available in fixed-density implementation")},s.prototype.reset=function(){var n=this.grid.data,o=0;for(o=0;o<n.length;o++)n[o]=0;this.samplePoints=[],this.currentPoint=null,this.processList.length=0},ke=s,ke}var Fe,Pt;function Es(){if(Pt)return Fe;Pt=1;var t=Jt().array,r=en(),i=tn();function a(n,o){for(var c=0,l=0;l<n.length;l++)c+=Math.pow(n[l]-o[l],2);return Math.sqrt(c)}function s(n,o){if(typeof n.distanceFunction!="function")throw new Error("PoissonDiskSampling: Tried to instantiate the variable density implementation without a distanceFunction");this.shape=n.shape,this.minDistance=n.minDistance,this.maxDistance=n.maxDistance||n.minDistance*2,this.maxTries=Math.ceil(Math.max(1,n.tries||30)),this.distanceFunction=n.distanceFunction,this.bias=Math.max(0,Math.min(1,n.bias||0)),this.rng=o||Math.random;for(var c=0,l=0;l<this.shape.length;l++)c=Math.max(c,this.shape[l]);var u=Math.max(1,c/128|0),d=1e-14*u;this.dimension=this.shape.length,this.minDistancePlusEpsilon=this.minDistance+d,this.deltaDistance=Math.max(0,this.maxDistance-this.minDistancePlusEpsilon),this.cellSize=this.maxDistance/Math.sqrt(this.dimension),this.neighbourhood=i(this.dimension),this.currentPoint=null,this.currentDistance=0,this.processList=[],this.samplePoints=[],this.sampleDistance=[],this.gridShape=[];for(var l=0;l<this.dimension;l++)this.gridShape.push(Math.ceil(this.shape[l]/this.cellSize));this.grid=t(this.gridShape)}return s.prototype.shape=null,s.prototype.dimension=null,s.prototype.minDistance=null,s.prototype.maxDistance=null,s.prototype.minDistancePlusEpsilon=null,s.prototype.deltaDistance=null,s.prototype.cellSize=null,s.prototype.maxTries=null,s.prototype.distanceFunction=null,s.prototype.bias=null,s.prototype.rng=null,s.prototype.neighbourhood=null,s.prototype.currentPoint=null,s.prototype.currentDistance=null,s.prototype.processList=null,s.prototype.samplePoints=null,s.prototype.sampleDistance=null,s.prototype.gridShape=null,s.prototype.grid=null,s.prototype.addRandomPoint=function(){for(var n=new Array(this.dimension),o=0;o<this.dimension;o++)n[o]=this.rng()*this.shape[o];return this.directAddPoint(n)},s.prototype.addPoint=function(n){var o,c=!0;if(n.length===this.dimension)for(o=0;o<this.dimension&&c;o++)c=n[o]>=0&&n[o]<this.shape[o];else c=!1;return c?this.directAddPoint(n):null},s.prototype.directAddPoint=function(n){var o=0,c=this.grid.stride,l=this.samplePoints.length,u;for(this.processList.push(l),this.samplePoints.push(n),this.sampleDistance.push(this.distanceFunction(n)),u=0;u<this.dimension;u++)o+=(n[u]/this.cellSize|0)*c[u];return this.grid.data[o].push(l),n},s.prototype.inNeighbourhood=function(n){var o=this.dimension,c=this.grid.stride,l,u,d,p,g,f,b=this.distanceFunction(n);for(l=0;l<this.neighbourhood.length;l++){for(u=0,d=0;d<o;d++){if(p=(n[d]/this.cellSize|0)+this.neighbourhood[l][d],p<0||p>=this.gridShape[d]){u=-1;break}u+=p*c[d]}if(u!==-1&&this.grid.data[u].length>0)for(var x=0;x<this.grid.data[u].length;x++){g=this.samplePoints[this.grid.data[u][x]],f=this.sampleDistance[this.grid.data[u][x]];var C=Math.min(f,b),j=Math.max(f,b),v=C+(j-C)*this.bias;if(a(n,g)<this.minDistance+this.deltaDistance*v)return!0}}return!1},s.prototype.next=function(){for(var n,o,c,l,u,d,p,g;this.processList.length>0;){if(this.currentPoint===null){var f=this.processList.shift();this.currentPoint=this.samplePoints[f],this.currentDistance=this.sampleDistance[f]}for(l=this.currentPoint,u=this.currentDistance,n=0;n<this.maxTries;n++){for(p=!0,c=this.minDistancePlusEpsilon+this.deltaDistance*(u+(1-u)*this.bias),this.dimension===2?(o=this.rng()*Math.PI*2,d=[Math.cos(o),Math.sin(o)]):d=r(this.dimension,this.rng),g=0;p&&g<this.dimension;g++)d[g]=l[g]+d[g]*c,p=d[g]>=0&&d[g]<this.shape[g];if(p&&!this.inNeighbourhood(d))return this.directAddPoint(d)}n===this.maxTries&&(this.currentPoint=null)}return null},s.prototype.fill=function(){for(this.samplePoints.length===0&&this.addRandomPoint();this.next(););return this.samplePoints},s.prototype.getAllPoints=function(){return this.samplePoints},s.prototype.getAllPointsWithDistance=function(){var n=new Array(this.samplePoints.length),o=0,c=0,l;for(o=0;o<this.samplePoints.length;o++){for(l=new Array(this.dimension+1),c=0;c<this.dimension;c++)l[c]=this.samplePoints[o][c];l[this.dimension]=this.sampleDistance[o],n[o]=l}return n},s.prototype.reset=function(){var n=this.grid.data,o=0;for(o=0;o<n.length;o++)n[o]=[];this.samplePoints=[],this.currentPoint=null,this.processList.length=0},Fe=s,Fe}var ze,St;function Ts(){if(St)return ze;St=1;var t=Ms(),r=Es();function i(a,s){this.shape=a.shape,typeof a.distanceFunction=="function"?this.implementation=new r(a,s):this.implementation=new t(a,s)}return i.prototype.implementation=null,i.prototype.addRandomPoint=function(){return this.implementation.addRandomPoint()},i.prototype.addPoint=function(a){return this.implementation.addPoint(a)},i.prototype.next=function(){return this.implementation.next()},i.prototype.fill=function(){return this.implementation.fill()},i.prototype.getAllPoints=function(){return this.implementation.getAllPoints()},i.prototype.getAllPointsWithDistance=function(){return this.implementation.getAllPointsWithDistance()},i.prototype.reset=function(){this.implementation.reset()},ze=i,ze}var Rs=Ts();const Ls=Mn(Rs);function $t(t,r){return Math.floor(Math.random()*(r-t+1)+t)}function Dt(t,r){return Math.random()*(r-t)+t}function Ns(t){return t[Math.floor(Math.random()*t.length)]}function ks({size:t,delay:r,...i}){const[a,s]=m.useState(!1);return m.useEffect(()=>{const n=setTimeout(()=>{m.startTransition(()=>{s(!0)})},r*Tt);return()=>{clearTimeout(n)}},[r]),a?e.jsx(h,{pointerEvents:"auto",width:t,height:t,...i}):null}const Fs=ye(h,{"$platform-web":{position:"absolute",transformOrigin:"center center",animationName:"cloud-float-animation",animationIterationCount:"infinite",animationTimingFunction:"linear"},variants:{duration:{":number":(t=0)=>({"$platform-web":{animationDuration:`${1e3*t}ms`}})}}}),zs=ye(h,{"$platform-web":{position:"absolute",transformOrigin:"center center",animationFillMode:"forwards",animationName:"token-rotate-animation",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDirection:"alternate-reverse"},variants:{duration:{":number":(t=0)=>({"$platform-web":{animationDuration:`${1e3*t}ms`}})}}}),Ut=ye(h,{borderWidth:1,borderColor:"$color",transformOrigin:"center center",position:"absolute",variants:{size:{":number":t=>({width:t,height:t})},rounded:{true:{"$platform-web":{borderRadius:"50%"}}}}}),Hs=ye(h,{backgroundSize:"cover",backgroundPosition:"center center",transition:"filter 0.15s ease-in-out",transformOrigin:"center center","$platform-web":{willChange:"filter"},variants:{logoUrl:{":string":t=>({backgroundImage:`url(${t})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"})},blur:{":number":t=>({filter:`blur(${t}px)`})},size:{":number":t=>({width:t,height:t})},rounded:{true:{"$platform-web":{borderRadius:"50%"}}}}});function Os({point:t,renderOuterElement:r,getElementRounded:i,onPress:a}){const{x:s,y:n,blur:o,size:c,rotation:l,opacity:u,delay:d,floatDuration:p,color:g}=t,f=c/8,b=200/(22-l);return e.jsx(h,{position:"absolute",group:"item",top:n,left:s,width:c,height:c,transformOrigin:"center center",children:e.jsx(h,{animation:"bouncy",enterStyle:{y:30},children:e.jsx(ks,{animation:"bouncy",delay:d,rotate:"15deg",opacity:1,scale:1,enterStyle:{scale:0,opacity:0,y:30,rotate:"-15deg"},exitStyle:{scale:3,opacity:0,rotate:"15deg",y:10},size:c,children:e.jsxs(Fs,{duration:p,children:[r&&r(t),e.jsx(zs,{duration:b,children:e.jsx(Hs,{size:c,animation:"fast",blur:o,backgroundColor:De(g),rounded:i==null?void 0:i(t),logoUrl:t.itemData.logoUrl,opacity:u,borderRadius:f,"$group-item-hover":{opacity:1,scale:1.2,rotate:`${Ns([0-l,0-l])}deg`,filter:"blur(0)",cursor:a?"pointer":void 0},onPress:a?()=>a(t):void 0,children:i&&e.jsxs(e.Fragment,{children:[e.jsx(Ut,{opacity:0,animation:"bouncy","$group-item-hover":{opacity:.3,scale:1.2},size:c,rounded:i(t),borderColor:De(g),borderRadius:f*1.3}),e.jsx(Ut,{opacity:0,animation:"bouncy","$group-item-hover":{opacity:.1,scale:1.4},size:c,rounded:i(t),borderColor:De(g),borderRadius:f*1.6})]})})})]})})})})}function _s({data:t,minItemSize:r=50,maxItemSize:i=96,onPress:a,renderOuterElement:s,getElementRounded:n}){const o=m.useMemo(()=>{const l=window.innerWidth,u=window.innerHeight-72,d=l/2-240,p=l/2+240,g={shape:[l,u],minDistance:250,maxDistance:375,tries:10};return new Ls(g).fill().sort((x,C)=>Math.abs(x[0]??0-l/2)-Math.abs(C[0]??0-l/2)).map(([x=0,C=0],j)=>{const v=t[j%t.length],P=$t(r,i);return{x,y:C,blur:1/P*500*(x>d&&x<p||C<100?5:1),size:P,color:v.color,opacity:Dt(.5,1)*(x>d&&x<p||C<100?.75:1),rotation:$t(-20,20),delay:Math.abs(x-l/2)/800,floatDuration:Dt(3,6),floatingElementPosition:x<d&&x+100>d||x+200>l?"left":"right",itemData:v}}).map(x=>({...x,y:x.y-.5*x.size,x:x.x-.5*x.size}))},[t,i,r]),c=m.useRef(null);return e.jsx(h,{ref:c,centered:!0,width:"100vw",position:"absolute",overflow:"hidden",inset:0,pointerEvents:"none",contain:"strict",children:o.map((l,u)=>e.jsx(Os,{point:l,renderOuterElement:s,getElementRounded:n,onPress:a},`token-${u}`))})}function Vs({children:t}){const r=Xe(),i=m.useMemo(()=>r?[{logoUrl:En},{logoUrl:Tn},{logoUrl:Rn},{logoUrl:Ln},{logoUrl:Nn},{logoUrl:kn},{logoUrl:Fn},{logoUrl:zn}]:[{logoUrl:Hn},{logoUrl:On},{logoUrl:_n},{logoUrl:Vn},{logoUrl:Bn},{logoUrl:Gn},{logoUrl:Wn},{logoUrl:qn}],[r]);return e.jsxs(h,{centered:!0,height:"100%",width:"100%",children:[e.jsx(h,{centered:!0,height:"100%",width:"100%",zIndex:At.default,children:t}),e.jsx(_s,{data:i,minItemSize:150,maxItemSize:175})]})}const Bs=({unitag:t,address:r,profilePictureUri:i})=>e.jsxs(h,{centered:!0,pb:"$spacing28",position:"relative",width:"100%",children:[e.jsx(st,{address:r,size:ue.image100,unitagAvatarUri:i}),e.jsx(h,{row:!0,position:"absolute",bottom:0,backgroundColor:"$surface1",borderRadius:"$rounded32",px:"$spacing12",py:"$spacing8",shadowColor:"$neutral3",shadowOpacity:.4,shadowRadius:"$spacing4",transform:[{rotateZ:"-2deg"}],zIndex:"$popover",alignSelf:"center",children:e.jsxs(y,{color:"$accent1",variant:"subheading1",numberOfLines:1,children:[t,e.jsx(y,{color:"$neutral3",variant:"subheading1",children:Ke})]})})]});function Gs(){const{t}=ae(),r=K(),{unitag:i,profilePicUri:a}=rt(),{goToNextStep:s}=Q(),n=()=>{s()};return m.useEffect(()=>{i||T.warn("UnitagConfirmationScreen.tsx","render","unitag is empty when it should have a value")},[i]),i?e.jsx(ve,{children:e.jsxs(h,{grow:!0,gap:"$spacing12",pt:"$spacing24",children:[e.jsx(h,{centered:!0,py:"$spacing12",children:e.jsx(Bs,{address:r,profilePictureUri:a,unitag:i})}),e.jsxs(h,{centered:!0,gap:"$spacing12",children:[e.jsx(y,{color:"$neutral1",textAlign:"center",variant:"heading3",children:t("unitags.claim.confirmation.success.long")}),e.jsx(y,{color:"$neutral2",textAlign:"center",variant:"subheading2",children:t("unitags.claim.confirmation.description",{unitagAddress:`${i}${Ke}`})})]}),e.jsxs(h,{gap:"$spacing12",pt:"$spacing12",children:[e.jsx(h,{row:!0,children:e.jsx(E,{size:"medium",variant:"branded",emphasis:"primary",onPress:_i,children:t("common.button.done")})}),e.jsx(h,{row:!0,children:e.jsx(E,{size:"medium",emphasis:"secondary",onPress:n,children:t("unitags.claim.confirmation.customize")})})]})]})}):e.jsx(e.Fragment,{})}function Ws(){const{t}=ae(),{goToNextStep:r,goToPreviousStep:i}=Q(),{setUnitag:a,setEntryPoint:s}=rt(),n=K(),o=m.useCallback(({unitag:c,entryPoint:l})=>{a(c),s(l),r()},[r,s,a]);return e.jsx(Je,{logImpression:!0,screen:kt.CreateUsername,children:e.jsx(ve,{Icon:e.jsx(_t,{backgroundColor:"$surface2",borderRadius:"$rounded12",height:ee.icon48,width:ee.icon48,children:e.jsx(Ce,{color:"$neutral1",size:"$icon.24"})}),title:t("unitags.onboarding.claim.title.choose"),subtitle:t("unitags.onboarding.claim.subtitle"),onBack:i,children:e.jsx(h,{gap:"$spacing24",pt:"$spacing24",width:"100%",children:e.jsx(li,{animateY:!1,unitagAddress:n,entryPoint:et.Home,onNavigateContinue:o})})})})}const qs=531,Ks=300;function Qs(){const{t}=ae(),{goToNextStep:r}=Q(),i=K(),{data:a}=Ze({params:i?{address:i}:void 0});return m.useEffect(()=>{a!=null&&a.address&&Rt(`/${he.EditProfile}`)},[a]),e.jsx(h,{centered:!0,height:"100%",width:"100%",children:e.jsxs(h,{centered:!0,width:qs,gap:"$spacing40",children:[e.jsxs(h,{gap:"$spacing12",children:[e.jsx(y,{color:"$neutral1",variant:"heading2",textAlign:"center",children:t("unitags.extension.intro.title")}),e.jsx(y,{color:"$neutral2",variant:"subheading1",textAlign:"center",children:t("unitags.extension.intro.description")})]}),e.jsxs(h,{gap:"$spacing40",style:{width:"fit-content"},children:[e.jsxs(h,{centered:!0,gap:"$spacing12",children:[e.jsxs(h,{row:!0,gap:"$spacing12",children:[e.jsx(He,{text:t("unitags.extension.intro.upsell.customizable"),Icon:Ce}),e.jsx(He,{text:t("unitags.extension.intro.upsell.free"),Icon:Gi})]}),e.jsx(He,{text:t("unitags.extension.intro.upsell.ens"),Icon:Bi})]}),e.jsxs(h,{gap:"$spacing24",children:[e.jsx(h,{row:!0,children:e.jsx(E,{size:"large",variant:"branded",onPress:()=>r(),children:t("unitags.extension.intro.buttton")})}),e.jsx(h,{width:Ks,alignSelf:"center",children:e.jsx(ci,{})})]})]})]})})}function He({Icon:t,text:r}){return e.jsxs(h,{row:!0,gap:"$spacing8",p:"$spacing12",borderWidth:"$spacing1",borderColor:"$surface3",borderRadius:"$rounded16",children:[e.jsx(t,{color:"$accent1",size:"$icon.24"}),e.jsx(y,{color:"$neutral2",variant:"body1",children:r})]})}const we=Kn([{path:"",element:e.jsx(Ys,{}),children:[{path:he.ClaimIntro,element:e.jsx(Zs,{}),errorElement:e.jsx(lt,{})},{path:he.EditProfile,element:e.jsx(Xs,{}),errorElement:e.jsx(lt,{})}]}]);we.subscribe(t=>{Qn(t)});ii(we);function Ys(){const[t,r]=Yn(),i=K(),a=Zn(i);return m.useEffect(()=>{t.get("address")!==i&&r({address:i})},[t,i,r]),m.useEffect(()=>{a&&i!==a&&we.navigate(0).catch(s=>T.error(s,{tags:{file:"UnitagClaimApp.tsx",function:"UnitagClaimAppInner"}}))},[i,a]),Xn(),e.jsx(tt,{})}function Zs(){return e.jsxs(h,{centered:!0,height:"100%",width:"100%",children:[e.jsx(zt,{disableRedirect:!0,steps:{[z.Intro]:e.jsx(Qs,{}),[z.CreateUsername]:e.jsx(Ws,{}),[z.ChooseProfilePic]:e.jsx(As,{}),[z.Confirmation]:e.jsx(Gs,{}),[z.EditProfile]:e.jsx(Zt,{enableBack:!0})},ContainerComponent:nn}),e.jsx(tt,{})]})}function nn({children:t}){const{step:r}=Q(),i=r!==z.Intro;return e.jsx(Ss,{children:e.jsx(Vs,{blurAll:i,children:t})})}function Xs(){return e.jsxs(h,{centered:!0,height:"100%",width:"100%",children:[e.jsx(zt,{disableRedirect:!0,steps:{[z.EditProfile]:e.jsx(Zt,{})},ContainerComponent:nn}),e.jsx(tt,{})]})}function Js(){return m.useEffect(()=>{Jn().catch(()=>{})},[]),e.jsx(ei,{appName:ti.UnitagClaim,children:e.jsx(ni,{router:we})})}globalThis.regeneratorRuntime=void 0;function er(){function t(){const r=document.getElementById("unitag-claim-root");ri.createRoot(r).render(e.jsx(m.StrictMode,{children:e.jsx(Js,{})}))}si({readOnly:!0}),t()}er();
